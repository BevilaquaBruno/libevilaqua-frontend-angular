<div class="row">
  <div class="col"></div>
  <div class="col">
    <form [formGroup]="form" novalidate (ngSubmit)="onSubmit()">
      <mat-card class="new-library-card">
        <mat-card-header>
          <mat-card-title>
            <b style="font-size: xx-large;">
              <button matIconButton aria-label="Voltar para o login" (click)="goBackToLogin()">
                <mat-icon>arrow_back</mat-icon>
              </button>
              Criar nova biblioteca
            </b>
          </mat-card-title>
          <mat-card-subtitle>
            Crie uma nova biblioteca para você no {{APP_NAME}}.
            @if ('' != displayError()) {
            <div class="text-center">
              <span class="red-text-button">{{displayError()}}</span>
            </div>
            }
            @if ('' != displaySuccessMessage()) {
            <div class="text-center">
              <span class="green-text-button">{{displaySuccessMessage()}}</span>
            </div>
            }
          </mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <h2 class="green-text-button">Biblioteca:</h2>
          <mat-divider></mat-divider>
          <br />
          <mat-form-field floatLabel="auto" class="full-width">
            <mat-label>Nome da biblioteca</mat-label>
            <input matInput placeholder="Biblioteca do John Doe" type="text" formControlName="libraryDescription"
              maxlength="50" />
            @if (form.get('libraryDescription')?.hasError('required') && form.get('libraryDescription')?.touched) {
            <mat-error>
              O nome da biblioteca é obrigatório.
            </mat-error>
            }

            @if (form.get('libraryDescription')?.hasError('maxLength') && form.get('libraryDescription')?.dirty) {
            <mat-error>
              O nome da biblioteca deve ter até 50 caracteres.
            </mat-error>
            }
          </mat-form-field>

          <h2 class="green-text-button">Usuário:</h2>
          <mat-divider></mat-divider>
          <br />

          <mat-form-field floatLabel="auto" class="full-width">
            <mat-label>Nome</mat-label>
            <input matInput placeholder="John Doe" type="text" formControlName="name" maxlength="50" />
            @if (form.get('name')?.hasError('required') && form.get('name')?.touched) {
            <mat-error>
              O nome é obrigatório.
            </mat-error>
            }

            @if (form.get('name')?.hasError('maxLength') && form.get('name')?.dirty) {
            <mat-error>
              O nome deve ter até 50 caracteres.
            </mat-error>
            }
          </mat-form-field>

          <mat-form-field floatLabel="auto" class="full-width">
            <mat-label>E-mail</mat-label>
            <input matInput placeholder="john@doe.com" type="email" formControlName="email" />
            @if (form.get('email')?.hasError('required') && form.get('email')?.touched) {
            <mat-error>
              O e-mail é obrigatório.
            </mat-error>
            }

            @if (form.get('email')?.hasError('email') && form.get('email')?.dirty) {
            <mat-error>
              Informe um e-mail válido.
            </mat-error>
            }

            @if (form.get('email')?.hasError('maxLength') && form.get('email')?.touched) {
            <mat-error>
              O e-mail deve ter até 50 caracteres.
            </mat-error>
            }
          </mat-form-field>

          <div class="row">
            <div class="col">
              <mat-form-field floatLabel="auto" class="full-width">
                <mat-label>Senha</mat-label>
                <input matInput placeholder="********" type="password" formControlName="password" />
                @if(form.get('password')?.hasError('required') && form.get('password')?.touched){
                <mat-error>
                  A senha é obrigatória.
                </mat-error>
                }

                @if(form.get('password')?.hasError('minlength') && form.get('password')?.dirty){
                <mat-error>
                  A senha deve ter pelo menos 6 caracteres.
                </mat-error>
                }
              </mat-form-field>
            </div>
            <div class="col">
              <mat-form-field floatLabel="auto" class="full-width">
                <mat-label>Repita a Senha</mat-label>
                <input matInput placeholder="********" type="password" type="password_confirmation"
                  formControlName="password_confirmation" />
                @if(form.get('password_confirmation')?.hasError('required') &&
                form.get('password_confirmation')?.touched){
                <mat-error>
                  A confirmação da senha é obrigatória.
                </mat-error>
                }

                @if(form.get('password_confirmation')?.hasError('differentPasswords') &&
                form.get('password_confirmation')?.touched){
                <mat-error>
                  As senhas não coincidem.
                </mat-error>
                }
              </mat-form-field>
            </div>
          </div>

          <mat-form-field floatLabel="auto" class="full-width">
            <mat-label>Idioma</mat-label>

            <mat-select formControlName="language">
              @for (lang of languages; track lang) {
              <mat-option [value]="lang">
                {{ lang }}
              </mat-option>
              }
            </mat-select>

            @if(form.get('language')?.hasError('required') && form.get('language')?.touched){
            <mat-error>
              O idioma é obrigatório.
            </mat-error>
            }
          </mat-form-field>
        </mat-card-content>
        <mat-card-actions>
          <button class="rect-button full-width" matButton="filled" type="submit">Criar biblioteca</button>
          <!-- <app-loading [loading]="isLoginLoading"></app-loading> -->
        </mat-card-actions>
      </mat-card>
    </form>
  </div>
  <div class="col"></div>
</div>
